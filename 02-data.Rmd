# データ整備

- AERパッケージに含まれるNMES1988を利用

```{r}
data("NMES1988",
     package = "AER")

raw <- NMES1988
```

## 新しい変数の作成: mutate (tidyverse)


- tidyverseパッケージに含まれるdplyrパッケージ[@R-dplyr]は、有用な関数を提供

```{r}
library(tidyverse)
```

- mutate関数の利用

```{r}
df <- mutate(raw,
              age_2 = age^2
              )
```


## 変数の限定: select (tidyverse)

- select関数の利用

```{r}
df <- select(raw,
             age,
             income
             )
```

- 特定の変数の除外

```{r}
df <- select(raw,
             -age,
             -income
             )
```

## サンプルの除外:filter (tidyverse)

- filter関数の利用

```{r}
df <- filter(raw,
             visits >= 7
             )
```



## 記述統計表の作成

- 記述統計の作成には多くの有益なパッケージが存在

- ここではgtsummary[@R-gtsummary]を使用

```{r}
library(gtsummary)
```

- select関数で必要な変数(visits, health, medicaid)を抜き出し、insuranceごとに連続変数については中央値、カテゴリ変数については頻度を記述

```{r}
descriptive <-
  select(raw,
         visits,
         health,
         medicaid,
         insurance)

tbl_summary(descriptive,
            by = insurance)
```

- 連続変数について、平均値と標準偏差を記述

```{r}
tbl_summary(descriptive,
            by = insurance,
            statistic = list(all_continuous() ~ "{mean} ({sd})"))
```

