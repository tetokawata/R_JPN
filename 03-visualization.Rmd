# 可視化

## 問題設定

- データ内におけるY/X間の関係性を整理・記述することが必要

- 最有力な手法は可視化

## パッケージ

- tidyverseに含まれるggplot2パッケージ[@R-ggplot2]を利用

```{r}
library(tidyverse)
library(AER)
```

## データ

```{r}
data("NMES1988")

raw <- NMES1988
```

- 変数のタイプに応じて、変数間の関係性を記述するために有効な図は異なる。
ここでは、Y/Xが共に連続(連続-連続)のケース、Xがカテゴリカル(連続-カテゴリ)なケースについて、代表的な図を紹介する

## 連続-カテゴリのケース

### ヒストグラム: geom_histogram (tidyverse)

- 医療機関の利用回数

```{r}
ggplot(raw, 
       aes(x = visits)
       ) +
  geom_histogram()
```

- 保険の有無別

```{r}
ggplot(raw, 
       aes(x = visits,
           fill = insurance)
       ) +
  geom_histogram(position = "identity",
                 alpha = 0.5)
```

### 密度: geom_density (tidyverse)

- 保険の有無別分布

````{r}
ggplot(raw, 
       aes(x = visits,
           fill = insurance)
       ) +
  geom_density(position = "identity",
                 alpha = 0.5)
```

### Boxplot: geom_boxplot (tidyverse)

```{r}
ggplot(raw,
       aes(y = visits,
           x = insurance)
       ) +
  geom_boxplot()
```

## 連続-連続のケース

### 散布図: geom_point (tidyverse)

- 散布図：連続変数間の関係性を可視化する図

```{r}
ggplot(raw,
       aes(x = age,
           y = visits)
       ) +
  geom_point()
```

- サンプルサイズが大きくなると機能しない

### ヒートマップ: geom_bin2d (tidyverse)

- 代替案はヒートマップ

```{r}
ggplot(raw,
       aes(x = age,
           y = visits)
       ) +
  geom_bin2d()
```
